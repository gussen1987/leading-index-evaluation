# Data Outputs

This directory contains all data generated by the Risk-On/Risk-Off Regime Index pipeline.

## Directory Structure

```
data/
├── cache/          # Raw daily price data from Yahoo Finance
├── processed/      # Weekly aligned and transformed data
├── exports/        # Excel workbooks for analysis
├── artifacts/      # HTML reports and run metadata
└── logs/           # Structured run logs (JSONL)
```

---

## Cache (`cache/`)

Raw daily price data fetched from Yahoo Finance, stored as Parquet files.

| File Pattern | Description | Count |
|--------------|-------------|-------|
| `yahoo_{TICKER}.parquet` | Daily OHLCV data | 33 files |

**Tickers Included:**

- **Equity ETFs:** SPY, RSP, IWM, QQQ, XLY, XLP, XLF, XLU, XLK, XLI
- **Factor ETFs:** SPHB, SPLV, MTUM, USMV, QUAL
- **Fixed Income:** TLT, IEF, SHY, HYG, LQD
- **Commodities:** GLD, USO, COPX, DBC
- **International:** EEM, EFA, ACWX, FXI
- **Volatility:** VIX, VVIX
- **FX:** AUDJPY, CADJPY, UUP

**Note:** FRED data (rates, spreads, macro) is NOT currently fetched due to missing API key configuration.

---

## Processed (`processed/`)

Weekly-aligned data (Friday close) with all transformations applied.

| File | Description |
|------|-------------|
| `weekly_latest.parquet` | All price series + ratios aligned to W-FRI |
| `features_latest.parquet` | Transformed features (z-scores, ROC, percentiles) |
| `blocks_latest.parquet` | 10 thematic block scores |
| `composites_latest.parquet` | Fast/Medium/Slow composite signals |
| `regimes_latest.parquet` | Regime labels + confidence scores |
| `checklist_latest.parquet` | 14-item bull market checklist |

### Block Scores

10 thematic blocks aggregating related signals:

1. `equity_leadership` - RSP/SPY, IWM/SPY, sector rotation
2. `factor_prefs` - High beta vs low vol, momentum vs min vol
3. `credit` - HYG/IEF, LQD/IEF, credit spreads
4. `rates` - Yield curve, real rates, breakevens
5. `fx` - AUD/JPY, CAD/JPY, dollar strength
6. `commodities` - Copper/gold, oil/gold, commodities/gold
7. `vol_liquidity` - VIX, VVIX, NFCI, rates vol proxy
8. `global` - EM/SPY, EAFE/SPY, ACWX/SPY, China/SPY
9. `defensive_rotation` - Utilities, duration, gold vs market
10. `macro_slow` - Claims, permits, sentiment

### Regime Labels

- **Risk-On:** Composite > 0.50
- **Neutral:** Composite between -0.50 and 0.50
- **Risk-Off:** Composite < -0.50

With hysteresis buffer (0.15) and minimum 2-week hold.

---

## Exports (`exports/`)

Excel workbooks for detailed analysis.

| File | Sheets | Description |
|------|--------|-------------|
| `weekly_data_latest.xlsx` | Prices, Ratios, Computed | All weekly price series and ratios |
| `block_scores_latest.xlsx` | Blocks, Current | Block scores over time + latest snapshot |
| `composites_latest.xlsx` | Composites, Regimes, Transitions | Composite signals and regime history |
| `checklist_latest.xlsx` | History, Current, Score | Bull market checklist tracking |
| `summary_dashboard_latest.xlsx` | Latest, Statistics | Current snapshot and descriptive stats |

---

## Artifacts (`artifacts/`)

Reports and run metadata.

| File | Description |
|------|-------------|
| `report_latest.html` | Interactive HTML dashboard (Plotly charts) |
| `report_{YYYYMMDD}.html` | Dated archive of HTML reports |
| `run_manifest.json` | Reproducibility metadata (config hashes, data timestamps) |

---

## Logs (`logs/`)

Structured run logs in JSONL format.

| File Pattern | Description |
|--------------|-------------|
| `risk_index_{YYYYMMDD}.jsonl` | Daily run logs with structured events |

---

## Data Gaps & Known Limitations

### FRED Data Not Fetched

The following series require a FRED API key (not configured):

- **Rates:** DGS10, DGS2, T10Y2Y, DFII10, T10YIE
- **Spreads:** BAMLH0A0HYM2 (HY OAS), BAMLC0A0CM (IG OAS)
- **Macro Weekly:** NFCI, ICSA (initial claims)
- **Macro Monthly:** PERMIT (building permits), UMCSENT (consumer sentiment)

To enable: Add `FRED_API_KEY=your_key` to `.env` file.

### Proxy Series

| Labeled As | Actual Source | Note |
|------------|---------------|------|
| `RATES_VOL_PROXY_21D` | TLT 21-day realized vol | NOT the MOVE index |
| Breadth signals | RSP/SPY, IWM/SPY ratios | Proxy breadth, not constituent-level |

---

## Refresh Cycle

Data is designed for **weekly refresh** after Friday market close.

- Run `scripts/run_update.py` to fetch and process
- Cache files are re-fetched if older than 1 day
- All `*_latest.*` files are overwritten on each run
- Use `--archive` flag to create dated copies
